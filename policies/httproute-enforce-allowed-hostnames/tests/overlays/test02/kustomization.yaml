apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- ../../base/
- namespace.yaml
nameSuffix: -test02
namespace: vaplibtest-httproutehostname-test02

patches:
- patch: |-
    apiVersion: admissionregistration.k8s.io/v1beta1
    kind: ValidatingAdmissionPolicyBinding
    metadata:
      name: vaplibtest-httproute-hostnames
    spec:
      matchResources:
        matchPolicy: Equivalent
        namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: vaplibtest-httproutehostname-test02
      paramRef:
        name: vaplibtest-param-test02
        namespace: vaplibtest-httproutehostname-test02
- patch: |-
    apiVersion: gateway.networking.k8s.io/v1beta1
    kind: HTTPRoute
    metadata:
      name: vaplibtest-httproute-example
    spec:
      hostnames:
      - notallowed.example.com
